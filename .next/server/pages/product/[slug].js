(()=>{var e={};e.id=915,e.ids=[915,888,660],e.modules={8049:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{config:()=>g,default:()=>p,getServerSideProps:()=>x,getStaticPaths:()=>m,getStaticProps:()=>h,reportWebVitals:()=>f,routeModule:()=>P,unstable_getServerProps:()=>S,unstable_getServerSideProps:()=>b,unstable_getStaticParams:()=>v,unstable_getStaticPaths:()=>y,unstable_getStaticProps:()=>j});var i=r(7093),a=r(5244),n=r(1323),c=r(1777),d=r.n(c),l=r(6719),o=r(8741),u=e([l,o]);[l,o]=u.then?(await u)():u;let p=(0,n.l)(o,"default"),h=(0,n.l)(o,"getStaticProps"),m=(0,n.l)(o,"getStaticPaths"),x=(0,n.l)(o,"getServerSideProps"),g=(0,n.l)(o,"config"),f=(0,n.l)(o,"reportWebVitals"),j=(0,n.l)(o,"unstable_getStaticProps"),y=(0,n.l)(o,"unstable_getStaticPaths"),v=(0,n.l)(o,"unstable_getStaticParams"),S=(0,n.l)(o,"unstable_getServerProps"),b=(0,n.l)(o,"unstable_getServerSideProps"),P=new i.PagesRouteModule({definition:{kind:a.x.PAGES,page:"/product/[slug]",pathname:"/product/[slug]",bundlePath:"",filename:""},components:{App:l.default,Document:d()},userland:o});s()}catch(e){s(e)}})},6873:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var s=r(997),i=r(1664),a=r.n(i);r(6689);let n=function(e){let{href:t,children:r,...i}=e;return s.jsx(a(),{href:t,...i,children:r})}},7397:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{Z:()=>f});var i=r(997),a=r(968),n=r.n(a),c=r(1664),d=r.n(c),l=r(3590),o=r(4962);r(8819);var u=r(6689),p=r(4917),h=r(1649),m=r(6873),x=r(9915),g=e([l,p,x]);[l,p,x]=g.then?(await g)():g;let f=function({title:e,children:t}){let{status:r,data:s}=(0,h.useSession)(),{state:a,dispatch:c}=(0,u.useContext)(p.y),{cart:g}=a,[f,j]=(0,u.useState)(0);return(0,u.useEffect)(()=>{j(g.cartItems.reduce((e,t)=>e+t.quantity,0))},[g.cartItems]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n(),{children:[i.jsx("title",{children:e?e+" - App E-Commerce":"App E-Commerce"}),i.jsx("meta",{name:"description",content:"Application Web E-Commerce"})]}),i.jsx(l.ToastContainer,{position:"bottom-center",limit:1}),(0,i.jsxs)("div",{className:"flex min-h-screen flex-col justify-between",children:[i.jsx("header",{children:(0,i.jsxs)("nav",{className:"flex h-12 items-center px-4 justify-between shadow-md",children:[i.jsx(d(),{href:"/",className:"text-lg font-bold",children:"samazone"}),(0,i.jsxs)("div",{className:"flex items-center z-10",children:[(0,i.jsxs)(d(),{href:"/cart",className:"p-2 text-blue-500",children:["Cart",f>0&&i.jsx("span",{className:"ml-1 rounded-full bg-red-600 px-2 py-1 text-xs font-bold text-white",children:f})]}),"loading"===r?"Loading":s?.user?(0,i.jsxs)(o.v,{as:"div",className:"relative inline-block",children:[i.jsx(o.v.Button,{className:"text-blue-500",children:s.user.name}),(0,i.jsxs)(o.v.Items,{className:"absolute right-0 w-56 origin-top-right bg-white  shadow-lg",children:[i.jsx(o.v.Item,{children:i.jsx(m.Z,{className:"dropdown-link",href:"/profile",children:"Profile"})}),i.jsx(o.v.Item,{children:i.jsx(m.Z,{className:"dropdown-link",href:"/order-history",children:"Order History"})}),s.user.isAdmin&&i.jsx(o.v.Item,{children:i.jsx(m.Z,{className:"dropdown-link",href:"/admin/dashboard",children:"Admin Dashboard"})}),i.jsx(o.v.Item,{children:i.jsx("a",{className:"dropdown-link",href:"#",onClick:()=>{x.default.remove("cart"),c({type:"CART_RESET"}),(0,h.signOut)({callbackUrl:"/login"})},children:"Logout"})})]})]}):i.jsx(d(),{href:"/login",className:"p-2 text-blue-500",children:"Login"})]})]})}),i.jsx("main",{className:"container m-auto mt-4 px-4",children:t}),i.jsx("footer",{className:"flex h-10 justify-center items-center shadow-inner",children:i.jsx("p",{children:"Copyright \xa9 2024"})})]})]})};s()}catch(e){s(e)}})},8887:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var s=r(1185),i=r.n(s);let a=new(i()).Schema({name:{type:String,required:!0},slug:{type:String,required:!0,unique:!0},category:{type:String,required:!0},image:{type:String,required:!0},price:{type:Number,required:!0},brand:{type:String,required:!0},rating:{type:Number,required:!0,default:0},numReviews:{type:Number,required:!0,default:0},countInStock:{type:Number,required:!0,default:0},description:{type:String,required:!0},isFeatured:{type:Boolean,default:!1},banner:String},{timestamps:!0}),n=i().models.Product||i().model("Product",a)},6719:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{default:()=>u});var i=r(997);r(6764);var a=r(1649),n=r(4917),c=r(1163),d=r(2929),l=e([n]);function o({children:e,adminOnly:t}){let r=(0,c.useRouter)(),{status:s,data:n}=(0,a.useSession)({required:!0,onUnauthenticated(){r.push("/unauthorized?message=login required")}});return"loading"===s?i.jsx("div",{children:"Loading..."}):(t&&!n.user.isAdmin&&r.push("/unauthorized?message=admin login required"),e)}n=(l.then?(await l)():l)[0];let u=function({Component:e,pageProps:{session:t,...r}}){return i.jsx(a.SessionProvider,{session:t,children:i.jsx(n.Z,{children:i.jsx(d.PayPalScriptProvider,{children:e.auth?i.jsx(o,{adminOnly:e.auth.adminOnly,children:i.jsx(e,{...r})}):i.jsx(e,{...r})})})})};s()}catch(e){s(e)}})},8741:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{default:()=>y,getServerSideProps:()=>j});var i=r(997),a=r(5675),n=r.n(a),c=r(1664),d=r.n(c),l=r(1163),o=r(6689),u=r(5904),p=r(8887),h=r(4917),m=r(7397),x=r(9648),g=r(3590),f=e([h,m,x,g]);async function j(e){let{params:t}=e,{slug:r}=t;await u.Z.connect();let s=await p.Z.findOne({slug:r}).lean();return await u.Z.disconnect(),{props:{product:s?u.Z.convertDocToObj(s):null}}}[h,m,x,g]=f.then?(await f)():f;let y=function(e){let{product:t}=e,{state:r,dispatch:s}=(0,o.useContext)(h.y),a=(0,l.useRouter)();if(!t)return i.jsx(m.Z,{title:"Product Not Found",children:i.jsx("div",{children:"Product Not Found"})});let c=async()=>{let e=r.cart.cartItems.find(e=>e.slug===t.slug),i=e?e.quantity+1:1,{data:n}=await x.default.get(`/api/products/${t._id}`);if(n.countInStock<i){g.toast.error("Sorry. Product is out of stock");return}s({type:"CART_ADD_ITEM",payload:{...t,quantity:i}}),g.toast.success("Product added to the cart"),a.push("/cart")};return(0,i.jsxs)(m.Z,{title:t.name,children:[i.jsx("div",{className:"my-2",children:i.jsx(d(),{href:"/",children:"Back to products"})}),(0,i.jsxs)("div",{className:"grid md:grid-cols-4 md:gap-3",children:[i.jsx("div",{className:"md:col-span-2",children:i.jsx(n(),{src:t.image,alt:t.name,width:640,height:640,layout:"responsive"})}),i.jsx("div",{children:(0,i.jsxs)("ul",{children:[i.jsx("li",{children:i.jsx("h1",{className:"text-lg",children:t.name})}),(0,i.jsxs)("li",{children:["Category: ",t.category]}),(0,i.jsxs)("li",{children:["Brand: ",t.brand]}),(0,i.jsxs)("li",{children:[t.rating," of ",t.numReviews," reviews"]}),i.jsx("li",{children:t.description})]})}),i.jsx("div",{children:(0,i.jsxs)("div",{className:"card p-5",children:[(0,i.jsxs)("div",{className:"mb-2 flex justify-between",children:[i.jsx("div",{children:"Price"}),(0,i.jsxs)("div",{children:["$",t.price]})]}),(0,i.jsxs)("div",{className:"mb-2 flex justify-between",children:[i.jsx("div",{children:"Status"}),i.jsx("div",{children:t.countInStock>0?"In Stock":"Unavailable"})]}),i.jsx("button",{className:"primary-button w-full",onClick:c,children:"Add to cart"})]})})]})]})};s()}catch(e){s(e)}})},4917:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{Z:()=>u,y:()=>l});var i=r(997),a=r(6689),n=r(9915),c=e([n]);n=(c.then?(await c)():c)[0];let l=(0,a.createContext)(),o={cart:n.default.get("cart")?JSON.parse(n.default.get("cart")):{cartItems:[],shippingAddress:{}}};function d(e,t){switch(t.type){case"CART_ADD_ITEM":{let r=t.payload,s=e.cart.cartItems.find(e=>e.slug===r.slug),i=s?e.cart.cartItems.map(e=>e.name===s.name?r:e):[...e.cart.cartItems,r];return n.default.set("cart",JSON.stringify({...e.cart,cartItems:i})),{...e,cart:{...e.cart,cartItems:i}}}case"CART_REMOVE_ITEM":{let r=e.cart.cartItems.filter(e=>e.slug!==t.payload.slug);return n.default.set("cart",JSON.stringify({...e.cart,cartItems:r})),{...e,cart:{...e.cart,cartItems:r}}}case"CART_RESET":return{...e,cart:{cartItems:[],shippingAddress:{location:{}},paymentMethod:""}};case"CART_CLEAR_ITEMS":return{...e,cart:{...e.cart,cartItems:[]}};case"SAVE_SHIPPING_ADDRESS":return{...e,cart:{...e.cart,shippingAddress:{...e.cart.shippingAddress,...t.payload}}};case"SAVE_PAYMENT_METHOD":return{...e,cart:{...e.cart,paymentMethod:t.payload}};default:return e}}let u=function({children:e}){let[t,r]=(0,a.useReducer)(d,o);return i.jsx(l.Provider,{value:{state:t,dispatch:r},children:e})};s()}catch(e){s(e)}})},5904:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var s=r(1185),i=r.n(s);let a={},n={connect:async function(){if(a.isConnected){console.log("already connected");return}if(i().connections.length>0){if(a.isConnected=i().connections[0].readyState,1===a.isConnected){console.log("use previous connection");return}await i().disconnect()}let e=await i().connect(process.env.MONGODB_URI);console.log("new connection"),a.isConnected=e.connections[0].readyState},disconnect:async function(){a.isConnected&&(await i().disconnect(),a.isConnected=!1)},convertDocToObj:function(e){return e._id=e._id.toString(),e.createdAt=e.createdAt.toString(),e.updatedAt=e.updatedAt.toString(),e}}},6764:()=>{},2929:e=>{"use strict";e.exports=require("@paypal/react-paypal-js")},1185:e=>{"use strict";e.exports=require("mongoose")},1649:e=>{"use strict";e.exports=require("next-auth/react")},2785:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{"use strict";e.exports=require("next/head")},6689:e=>{"use strict";e.exports=require("react")},6405:e=>{"use strict";e.exports=require("react-dom")},997:e=>{"use strict";e.exports=require("react/jsx-runtime")},9648:e=>{"use strict";e.exports=import("axios")},9915:e=>{"use strict";e.exports=import("js-cookie")},3590:e=>{"use strict";e.exports=import("react-toastify")},7147:e=>{"use strict";e.exports=require("fs")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},9796:e=>{"use strict";e.exports=require("zlib")}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[255,163,777,176,675],()=>r(8049));module.exports=s})();