"use strict";(()=>{var e={};e.id=373,e.ids=[373],e.modules={1185:e=>{e.exports=require("mongoose")},614:e=>{e.exports=require("next-auth/jwt")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,n){return n in t?t[n]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,n)):"function"==typeof t&&"default"===n?t:void 0}}})},6937:(e,t,n)=>{n.r(t),n.d(t,{config:()=>m,default:()=>g,routeModule:()=>f});var i={};n.r(i),n.d(i,{default:()=>y});var o=n(1802),d=n(7153),r=n(6249),a=n(614),c=n(8350),s=n(544);let u=async(e,t)=>{await s.Z.connect();let n=await c.Z.findById(e.query.id);await s.Z.disconnect(),t.send(n)},l=async(e,t)=>{await s.Z.connect();let n=await c.Z.findById(e.query.id);n?(n.name=e.body.name,n.slug=e.body.slug,n.price=e.body.price,n.category=e.body.category,n.image=e.body.image,n.brand=e.body.brand,n.countInStock=e.body.countInStock,n.description=e.body.description,await n.save(),await s.Z.disconnect(),t.send({message:"Product update successfully"})):(await s.Z.disconnect(),t.status(404).send({message:"Product not found"}))},p=async(e,t)=>{await s.Z.connect();let n=await c.Z.findById(e.query.id);n?(await n.deleteOne(),await s.Z.disconnect(),t.send({message:"Product deleted successfully"})):(await s.Z.disconnect(),t.status(404).send({message:"Product not found"}))},y=async(e,t)=>{let n=await (0,a.getToken)({req:e});return n||n.isAdmin?"GET"===e.method?u(e,t,n):"PUT"===e.method?l(e,t,n):"DELETE"===e.method?p(e,t,n):t.status(400).send({message:"Method not allowed"}):t.status(401).send("signin required")},g=(0,r.l)(i,"default"),m=(0,r.l)(i,"config"),f=new o.PagesAPIRouteModule({definition:{kind:d.x.PAGES_API,page:"/api/admin/products/[id]",pathname:"/api/admin/products/[id]",bundlePath:"",filename:""},userland:i})},8350:(e,t,n)=>{n.d(t,{Z:()=>r});var i=n(1185),o=n.n(i);let d=new(o()).Schema({name:{type:String,required:!0},slug:{type:String,required:!0,unique:!0},category:{type:String,required:!0},image:{type:String,required:!0},price:{type:Number,required:!0},brand:{type:String,required:!0},rating:{type:Number,required:!0,default:0},numReviews:{type:Number,required:!0,default:0},countInStock:{type:Number,required:!0,default:0},description:{type:String,required:!0},isFeatured:{type:Boolean,default:!1},banner:String},{timestamps:!0}),r=o().models.Product||o().model("Product",d)},544:(e,t,n)=>{n.d(t,{Z:()=>r});var i=n(1185),o=n.n(i);let d={},r={connect:async function(){if(d.isConnected){console.log("already connected");return}if(o().connections.length>0){if(d.isConnected=o().connections[0].readyState,1===d.isConnected){console.log("use previous connection");return}await o().disconnect()}let e=await o().connect(process.env.MONGODB_URI);console.log("new connection"),d.isConnected=e.connections[0].readyState},disconnect:async function(){d.isConnected&&(await o().disconnect(),d.isConnected=!1)},convertDocToObj:function(e){return e._id=e._id.toString(),e.createdAt=e.createdAt.toString(),e.updatedAt=e.updatedAt.toString(),e}}},7153:(e,t)=>{var n;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return n}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(n||(n={}))},1802:(e,t,n)=>{e.exports=n(145)}};var t=require("../../../../webpack-api-runtime.js");t.C(e);var n=t(t.s=6937);module.exports=n})();