"use strict";(()=>{var e={};e.id=451,e.ids=[451],e.modules={8432:e=>{e.exports=require("bcryptjs")},1185:e=>{e.exports=require("mongoose")},614:e=>{e.exports=require("next-auth/jwt")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,n){return n in t?t[n]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,n)):"function"==typeof t&&"default"===n?t:void 0}}})},1260:(e,t,n)=>{n.r(t),n.d(t,{config:()=>m,default:()=>f,routeModule:()=>g});var i={};n.r(i),n.d(i,{default:()=>p});var r=n(1802),o=n(7153),a=n(6249),s=n(614),d=n(8432),c=n.n(d),u=n(1075),l=n(544);let p=async function(e,t){if("PUT"!==e.method)return t.status(400).send({message:`${e.method} not supported`});let n=await (0,s.getToken)({req:e});if(!n)return t.status(401).send("signin required");let{name:i,email:r,password:o}=e.body;if(!i||!r||!r.includes("@")||o&&o.trim().length<5){t.status(422).json({message:"validation error"});return}await l.Z.connect();let a=await u.Z.findById(n._id);a.name=i,a.email=r,o&&(a.password=c().hashSync(o)),await a.save(),await l.Z.disconnect(),t.send({message:"User updated"})},f=(0,a.l)(i,"default"),m=(0,a.l)(i,"config"),g=new r.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/auth/update",pathname:"/api/auth/update",bundlePath:"",filename:""},userland:i})},1075:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(1185),r=n.n(i);let o=new(r()).Schema({name:{type:String,required:!0},email:{type:String,required:!0,unique:!0},password:{type:String,required:!0},isAdmin:{type:Boolean,required:!0,default:!1}},{timestamps:!0}),a=r().models.User||r().model("User",o)},544:(e,t,n)=>{n.d(t,{Z:()=>a});var i=n(1185),r=n.n(i);let o={},a={connect:async function(){if(o.isConnected){console.log("already connected");return}if(r().connections.length>0){if(o.isConnected=r().connections[0].readyState,1===o.isConnected){console.log("use previous connection");return}await r().disconnect()}let e=await r().connect(process.env.MONGODB_URI);console.log("new connection"),o.isConnected=e.connections[0].readyState},disconnect:async function(){o.isConnected&&(await r().disconnect(),o.isConnected=!1)},convertDocToObj:function(e){return e._id=e._id.toString(),e.createdAt=e.createdAt.toString(),e.updatedAt=e.updatedAt.toString(),e}}},7153:(e,t)=>{var n;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return n}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(n||(n={}))},1802:(e,t,n)=>{e.exports=n(145)}};var t=require("../../../webpack-api-runtime.js");t.C(e);var n=t(t.s=1260);module.exports=n})();